# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
```{r}
unzip("activity.zip")
activityData <- read.csv("activity.csv")
activityData$date <- as.Date(activityData$date, format="%Y-%m-%d")

```



## What is mean total number of steps taken per day?
```{r}
totalStepDay <- sapply( split(activityData, activityData$date), 
                        function(x) sum(x$steps, na.rm=TRUE)
                      )
hist(totalStepDay)
meanStepDay <- sapply( split(activityData, activityData$date), 
                        function(x) mean(x$steps, na.rm=TRUE)
                      )
medianStepDay <- sapply( split(activityData, activityData$date), 
                        function(x) median(x$steps, na.rm=TRUE)
                        )
data.frame(meanSteps=meanStepDay, medianSteps=medianStepDay)
```


## What is the average daily activity pattern?
```{r}
meanStepInterval <- sapply( split(activityData, activityData$interval),
                            function(x) mean(x$steps, na.rm=T)
                            )
maxMeanStep <- max(meanStepInterval)
maxInterval <- names(meanStepInterval)[which(meanStepInterval==maxMeanStep)]
plot(meanStepInterval, type="l")
```
The maximum mean step of `r maxMeanStep` was observed in interval `r maxInterval`.


## Imputing missing values
A total of `r sum(!complete.cases(activityData))` out of `r nrow(activityData)` rows are incomplete.
```{r}
activityImputData <- activityData
repMeanStep <- rep(meanStepInterval, length(unique(activityData$date)))
activityImputData$steps[is.na(activityImputData$steps)] <- as.integer(repMeanStep[is.na(activityImputData$steps)])
```
```{r}
totalStepDay <- sapply( split(activityImputData, activityImputData$date), 
                        function(x) sum(x$steps, na.rm=TRUE)
                      )
hist(totalStepDay)
meanStepDay <- sapply( split(activityImputData, activityImputData$date), 
                        function(x) mean(x$steps, na.rm=TRUE)
                      )
medianStepDay <- sapply( split(activityImputData, activityImputData$date), 
                        function(x) median(x$steps, na.rm=TRUE)
                        )
data.frame(meanSteps=meanStepDay, medianSteps=medianStepDay)
```




## Are there differences in activity patterns between weekdays and weekends?
```{r}
activityImputData$day <- weekdays(activityImputData$date)
activityImputData$day[activityImputData$day %in% c("Saturday", "Sunday")] <- "Weekend"
activityImputData$day[!(activityImputData$day %in% c("Weekend"))] <- "Weekday"

step_by_day <- split(activityImputData, activityImputData$day)
mean_step_weekday <- sapply( split(step_by_day[["Weekday"]], step_by_day[["Weekday"]]$interval),
                             function(x) mean(x$steps) )
mean_step_weekend <- sapply( split(step_by_day[["Weekend"]], step_by_day[["Weekend"]]$interval),
                             function(x) mean(x$steps) )
par(mfrow=c(2,1))
plot(mean_step_weekend,
     type="l",
     main="weekend",
     xlab="Interval",
     ylab="Number of steps")
plot(mean_step_weekday,
     type="l",
     main="weekday",
     xlab="Interval",
     ylab="Number of steps")

```